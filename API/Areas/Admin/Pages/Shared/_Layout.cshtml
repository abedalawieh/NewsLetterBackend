<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>@ViewData["Title"] - Newsletter Intelligence</title>
    <!-- Local Libraries -->
    <link rel="stylesheet" href="~/lib/bootstrap/bootstrap.min.css" />
    <link rel="stylesheet" href="~/lib/bootstrap-icons/bootstrap-icons.min.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" />
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- Bundled Admin Styles -->
    <link rel="stylesheet" href="~/css/admin.min.css" asp-append-version="true" />
    
    <style>
        /* Existing overrides */
        :root {
            --sidebar-bg: #0c1222;
            --main-bg: #070d19;
            --accent: #0ea5e9;
            --accent-hover: #38bdf8;
            --card-bg: #0f172a;
            --card-border: rgba(148, 163, 184, 0.12);
            --text: #f1f5f9;
            --text-muted: #94a3b8;
            --success: #22c55e;
            --danger: #ef4444;
            --warning: #f59e0b;
        }
        body { font-family: 'Inter', sans-serif; background: var(--main-bg); color: var(--text); overflow-x: hidden; }
        .sidebar { height: 100vh; background: var(--sidebar-bg); border-right: 1px solid var(--card-border); position: fixed; width: 260px; z-index: 1000; }
        .main-content { margin-left: 260px; min-height: 100vh; padding: 2rem; }
        .nav-link { color: var(--text-muted); padding: 0.8rem 1.5rem; display: flex; align-items: center; border-radius: 0.5rem; margin: 0.2rem 1rem; transition: all 0.2s; }
        .nav-link:hover { color: var(--text); background: rgba(14, 165, 233, 0.08); }
        .nav-link.active { background: var(--accent); color: white; }
        .nav-link i { width: 24px; margin-right: 12px; font-size: 1.1rem; }
        .card { background: var(--card-bg); border: 1px solid var(--card-border); border-radius: 0.75rem; box-shadow: 0 4px 6px -1px rgba(0,0,0,0.2); }
        .stat-card { padding: 1.5rem; }
        .table { color: #cbd5e1; vertical-align: middle; background-color: transparent !important; }
        .table thead th { background: rgba(15, 23, 42, 0.6); border-bottom: 1px solid var(--card-border); color: var(--text-muted); font-weight: 600; text-transform: uppercase; font-size: 0.75rem; letter-spacing: 0.05em; padding: 1rem; }
        .table tbody td { border-bottom: 1px solid var(--card-border); padding: 1rem; background-color: transparent !important; color: #cbd5e1 !important; }
        .btn-primary { background: var(--accent); border: none; padding: 0.6rem 1.2rem; border-radius: 0.5rem; font-weight: 500; }
        .btn-primary:hover { background: var(--accent-hover); }
        .badge { padding: 0.4rem 0.7rem; border-radius: 0.375rem; font-weight: 500; font-size: 0.75rem; }
        .alert-success { --bs-alert-color: var(--success); --bs-alert-bg: rgba(34, 197, 94, 0.15); }
        .alert-danger { --bs-alert-color: var(--danger); --bs-alert-bg: rgba(239, 68, 68, 0.15); }
    </style>
</head>
<body class="admin-body">
    @if (User.Identity.IsAuthenticated)
    {
        <aside class="sidebar">
            <div class="p-4 mb-4">
                <h4 class="text-white d-flex align-items-center fw-bold">
                    <i class="fas fa-paper-plane me-3" style="color: var(--accent);"></i>Newsletter
                </h4>
            </div>
            <nav class="nav flex-column mt-2">
                <a class="nav-link @(ViewContext.RouteData.Values["page"].ToString().Contains("/Dashboard") ? "active" : "")" asp-area="Admin" asp-page="/Dashboard">
                    <i class="fas fa-th-large"></i> Dashboard
                </a>
                <a class="nav-link @(ViewContext.RouteData.Values["page"].ToString().Contains("/Subscribers") ? "active" : "")" asp-area="Admin" asp-page="/Subscribers/Index">
                    <i class="fas fa-users"></i> Subscribers
                </a>
                <a class="nav-link @(ViewContext.RouteData.Values["page"].ToString().Contains("/UnsubscribeAnalytics") ? "active" : "")" asp-area="Admin" asp-page="/UnsubscribeAnalytics/Index">
                    <i class="fas fa-chart-line"></i> Unsubscribe Analytics
                </a>
                <a class="nav-link @(ViewContext.RouteData.Values["page"].ToString().Contains("/Metadata") ? "active" : "")" asp-area="Admin" asp-page="/Metadata/Index">
                    <i class="fas fa-tags"></i> Metadata
                </a>
                <a class="nav-link @(ViewContext.RouteData.Values["page"].ToString().Contains("/Admins") ? "active" : "")" asp-area="Admin" asp-page="/Admins/Index">
                    <i class="fas fa-shield-alt"></i> Administrators
                </a>
                <a class="nav-link @(ViewContext.RouteData.Values["page"].ToString().Contains("/Newsletters") ? "active" : "")" asp-area="Admin" asp-page="/Newsletters/Index">
                    <i class="fas fa-envelopes-bulk"></i> Campaigns
                </a>
                <a class="nav-link @(ViewContext.RouteData.Values["page"].ToString().Contains("/Deleted") ? "active" : "")" asp-area="Admin" asp-page="/Deleted/Index">
                    <i class="fas fa-trash-restore"></i> Deleted Items
                </a>
            </nav>
            <div style="position:absolute; bottom:20px; width:100%">
                <hr class="mx-4 opacity-10" />
                <a class="nav-link text-warning" asp-area="Admin" asp-page="/Account/Logout">
                    <i class="fas fa-sign-out-alt"></i> Logout
                </a>

            </div>
        </aside>
    }

    <main class="@(User.Identity.IsAuthenticated ? "main-content" : "")">
        <partial name="_Alerts" />
        @RenderBody()
    </main>

    <!-- Local Scripts -->
    <script src="~/lib/jquery.min.js"></script>
    <script src="~/lib/bootstrap/bootstrap.bundle.min.js"></script>
    
    <!-- Bundled Admin Logic -->
    <script src="~/js/admin.min.js" asp-append-version="true"></script>
    
    @await RenderSectionAsync("Scripts", required: false)
</body>
</html>
